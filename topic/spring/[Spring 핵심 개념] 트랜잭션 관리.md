### 트랜잭션 관리

서로 의존하는 여러 작업을 하나의 작업 단위로 묶어, 모두 성공하거나 모두 실패하도록 보장하는 메커니즘입니다.

트랜잭션의 특징

- Atomicity (원자성)
    - 트랜잭션 내의 모든 작업이 완전히 수행되거나, 전혀 수행되지 않아야 함
- Consistency (일관성)
    - 트랜잭션이 성공적으로 완료되면 데이터는 항상 일관된 상태를 유지해야 함
- Isolation (격리성)
    - 동시에 실행되는 여러 트랜잭션이 서로의 작업에 간섭하지 않도록 보장
- Durability (지속성)
    - 트랜잭션이 성공적으로 완료되면 그 결과는 영구적으로 저장되어야 함

<br />

### 왜 사용할까?

트랜잭션은 다음과 같은 이유로 사용합니다.

- 데이터 일관성 보장
    - 여러 작업 중 일부만 성공하는 부분 업데이트를 방지하여, 데이터의 일관성 유지
- 중간 실패 시 데이터 복구 (Rollback)
    - 비즈니스 로직 도중 예외나 오류가 발생하면 자동으로 이전 정상 상태로 복구하여 데이터 무결성을 유지
- 동시성 제어
    - 여러 사용자가 동시에 동일한 데이터에 접근하거나 수정하는 상황에서도 데이터 충돌이나 불일치가 발생하지 않도록 보장

<br />

### 스프링에서 트랜잭션 관리

스프링 트랜잭션 관리 방식

- 선언적 트랜잭션 관리
    - @Transactional 사용
    - 메서드가 시작될 때 트랜잭션이 시작되고, 정상 종료되면 트랜잭션을 커밋
    - 예외 발생 시 자동 롤백
- 명시적 트랜잭션 관리
    - PlatformTransactionManager 사용
    - 트랜잭션의 시작, 커밋, 롤백을 코드로 작성
    - 더 세밀한 제어가 가능하지만 복잡

<br />

### 스프링 트랜잭션의 동작 흐름

- @Transactional이 붙은 클래스 또는 메서드를 스프링이 감지 (Pointcut)
- 스프링 AOP가 해당 클래스의 프록시 객체를 생성
- 메서드가 호출될 때, 프록시 객체가 호출을 가로챔
    - 메서드 실행 전 : 트랜잭션 시작
    - 메서드 실행 (비즈니스 로직)
    - 메서드 실행 후 : 성공 시 커밋, 예외 발생 시 롤백
- 트랜잭션 종료 후 결과 반환

<br />

### 결론

트랜잭션은 서로 의존하는 여러 작업을 하나의 작업 단위로 묶어 모두 성공하거나 모두 실패하도록 보장하는 메커니즘입니다.  
스프링에서 제공하는 @Transactional을 사용하면 복잡한 트랜잭션 관리 로직을 별도로 작성하지 않아도, 선언적으로 트랜잭션을 시작하고 성공 시 커밋, 실패 시 롤백을 자동으로 처리할 수 있습니다.

<br />

#### 참고 자료

- ChatGPT 대화 내용